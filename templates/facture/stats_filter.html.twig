
   
   {% extends 'baseFront.html.twig' %}

{% block title %}Statistiques{% endblock %}

{% block body %}
 <h1>Statistiques pour le type de facture</h1>

    {{ form_start(form) }}
    {{ form_row(form.type) }}
    {{ form_row(form.startDate) }}
    {{ form_row(form.endDate) }}
    {{ form_row(form.submit) }}
    {{ form_end(form) }}
    <h2>Résultats des statistiques</h2>
         {% if type is not null %}
    <p>Type de facture sélectionné : {{ type }}</p>
{% endif %}
{% if startDate is not null and endDate is not null %}
    <p>Période sélectionnée : {{ startDate|date('Y-m-d') }} à {{ endDate|date('Y-m-d') }}</p>
{% endif %}
<p>Consommation totale : {{ consommationTotale }}</p>
<p>Montant total : {{ montantTotal }}</p>
{% if factures is not empty %}
    <!-- Canvas pour le graphique -->
    <canvas id="myChart" width="400" height="400"></canvas>
    <canvas id="myPieChart" width="400" height="400"></canvas>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
     // Données pour le graphique à cercles
    var pieLabels = [];
    var pieConsommations = [];
    var pieMontants = [];
    {% for facture in factures %}
        pieLabels.push("Facture {{ facture.numfacture }}");
        pieConsommations.push({{ facture.consommation }});
        pieMontants.push({{ facture.montant }});
    {% endfor %}
        // Données pour le graphique
        var labels = [];
        var consommations = [];
        var montants = [];
        {% for facture in factures %}
            labels.push("Facture {{ facture.numfacture }}");
            consommations.push({{ facture.consommation }});
            montants.push({{ facture.montant }});
        {% endfor %}

        // Créer un nouveau graphique
        var ctx = document.getElementById('myChart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Consommation',
                    data: consommations,
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                },
                {
                    label: 'Montant',
                    data: montants,
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

    </script>
{% endif %}
{% endblock %}
